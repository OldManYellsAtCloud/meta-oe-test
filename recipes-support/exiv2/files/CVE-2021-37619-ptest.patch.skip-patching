CVE-2021-37619 test

Upstream-Status: Backport []
Signed-off-by: Gyorgy Sarvari <skandigraun@gmail.com>

diff --git a/test/data/issue_ghsa_mxw9_qx4c_6m8v_poc.jp2 b/test/data/issue_ghsa_mxw9_qx4c_6m8v_poc.jp2
new file mode 100644
index 0000000000000000000000000000000000000000..47ad82ee7123a3b0aa2541295f5ca098bd0ccfae
GIT binary patch
literal 1692
zcmds2K}#D!6#gcwQDbAGg!Wd3J(WUg&`U|<f~a7`LXgtl3hmCW*$|U-vw?bPMTK69
zARfH-?A1TfKj7IPB89#;yKc0MsbEi?!_0fLZ@+o--uK=Bc+_f0na_R80Vw&=Zm-o_
zkR+oRuVvDkq&^OsDg@5=N&X3IVuEc@aJ%hLm;n-?KLB6?&{##96K@1>jP_<qg)1<E
z{WEXIoxvbb8@=r}f$y(<4*asS(O9V0pJS5TTVx;a7&9V+6CwHQ1EO%hoZK0OLqk#x
z-msISauP@3!W@OuzefQ$!&ekUCg?>$x8vlblr`m6`^O(!UWLZn#!JcTaJ;HiY_gL5
zXv_1fs_PDRyiQbqv1Gr~M$3A}FFX-eeSLKc%$J(5^olXi{uokPPnRxl(Yh<iI%Q=^
z)7lt;A(6gEyMrWjXdUYMU;s3!ETEcH7e)Ylq7TK>l-Bo4=q<1eX_lDNH_MWo)wjHw
z$?}!Q_W(P&wnchgOp@V|HqH|TnWhXdE2i`w>vM^{P#mT>WY2hIK!Kfh_4S9&_L8l<
z^2)mH43k1q#2Qapc*<IBK2(0S9q6>mSX*vK4v@P(h;Xl+`9g=xQf`F#Cryoc;)e42
zZutN4<whSh^Myk7K)x_S!F@lfDgPjol>Tv7H+plhIZfUW%cu?RaT`1~wZS}}XdKCl
RVZ<Jm*3Bm;Eiry_egg(t96kU5

literal 0
HcmV?d00001

diff --git a/tests/bugfixes/github/test_issue_ghsa_mxw9_qx4c_6m8v.py b/tests/bugfixes/github/test_issue_ghsa_mxw9_qx4c_6m8v.py
new file mode 100644
index 0000000000..8f8b6676cf
--- /dev/null
+++ b/tests/bugfixes/github/test_issue_ghsa_mxw9_qx4c_6m8v.py
@@ -0,0 +1,18 @@
+# -*- coding: utf-8 -*-
+
+from system_tests import CaseMeta, CopyTmpFiles, path, check_no_ASAN_UBSAN_errors
+@CopyTmpFiles("$data_path/issue_ghsa_mxw9_qx4c_6m8v_poc.jp2")
+
+class Jp2ImageEncodeJp2HeaderOutOfBoundsRead2(metaclass=CaseMeta):
+    """
+    Regression test for the bug described in:
+    https://github.com/Exiv2/exiv2/security/advisories/GHSA-mxw9-qx4c-6m8v
+    """
+    url = "https://github.com/Exiv2/exiv2/security/advisories/GHSA-mxw9-qx4c-6m8v"
+
+    filename = path("$tmp_path/issue_ghsa_mxw9_qx4c_6m8v_poc.jp2")
+    commands = ["$exiv2 rm $filename"]
+    stdout = [""]
+    retval = [0]
+
+    compare_stderr = check_no_ASAN_UBSAN_errors
